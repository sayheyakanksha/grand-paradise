---
import ArticleRecsSideCard from "@/components/cards/articleRecsSideCard.astro";
import { articlesHandler } from "@/lib/handlers/articles";
import type { CollectionEntry } from "astro:content";

type Props = {
  article: CollectionEntry<"articles">;
};

const { article } = Astro.props;
const allArticles = articlesHandler.allArticles();
const articles = allArticles.filter((a) => a.id !== article.id).slice(0, 3);
---

<section
  class="container grid max-w-6xl grid-cols-1 gap-20 pt-4 md:grid-cols-10 md:pt-8"
  data-pagefind-ignore="all"
>
  <div class="col-span-1 md:col-span-7">
    <article
      class="prose md:prose-lg prose-img:border prose-img:mx-auto prose-img:border-base-200 prose-img:rounded-lg prose-p:wrap-break-word prose-a:break-all prose-pre:wrap-break-word prose-pre:cursor-text prose-code:wrap-break-word prose-code:whitespace-pre-wrap mx-auto max-w-6xl text-left"
      data-pagefind-body
    >
      <slot />
      <br />
    </article>
  </div>
  <div class="col-span-1 md:col-span-3">
    {
      articles.map((article, index) => (
        <ArticleRecsSideCard
          article={article}
          isFirst={index === 0}
          isLast={index === 2}
        />
      ))
    }
  </div>
</section>
